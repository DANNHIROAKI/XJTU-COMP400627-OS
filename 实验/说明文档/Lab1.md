# xv6-labsï¼šlab 1

### ä½œä¸šå†…å®¹
#### å®žéªŒèƒŒæ™¯
xv6åªæ”¯æŒå°‘é‡çš„shellå‘½ä»¤ï¼Œå› æ­¤éœ€è¦æ·»åŠ å¸¸ç”¨çš„shellå‘½ä»¤ã€‚

#### å®žéªŒå†…å®¹ 1ï¼šå®žçŽ°sleepå‘½ä»¤ ï¼ˆðŸ°ï¼‰
ä¸ºxv6å®žçŽ°ç”¨æˆ·çº§çš„sleepå‘½ä»¤ï¼Œç±»ä¼¼äºŽUNIXä¸­çš„'sleep'å‘½ä»¤ã€‚å®žçŽ°çš„'sleep'åº”è¯¥æš‚åœä¸€æ®µç”¨æˆ·æŒ‡å®šçš„æ—¶é’Ÿæ»´ç­”æ•°ã€‚åœ¨xv6å†…æ ¸ä¸­ï¼Œæ»´ç­”ï¼ˆtickï¼‰æ˜¯ä¸€ä¸ªæ—¶é—´æ¦‚å¿µï¼Œæ¥è‡ªè®¡æ—¶å™¨èŠ¯ç‰‡çš„ä¸¤æ¬¡ä¸­æ–­ä¹‹é—´çš„æ—¶é—´ã€‚

##### æç¤º
+ åœ¨å¼€å§‹ç¼–ç ä¹‹å‰ï¼Œé˜…è¯»xv6ä¹¦ç±çš„ç¬¬1ç« ã€‚
+ å°†ä½ çš„ä»£ç æ”¾åœ¨'user/sleep.c'æ–‡ä»¶ä¸­ã€‚æŸ¥çœ‹'user/'ç›®å½•ä¸­çš„å…¶ä»–ä¸€äº›ç¨‹åºï¼Œä¾‹å¦‚'user/echo.c'ã€'user/grep.c'å’Œ'user/rm.c'ï¼Œä»¥äº†è§£å¦‚ä½•å°†å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™ç¨‹åºã€‚
+ å°†ä½ çš„'sleep'ç¨‹åºæ·»åŠ åˆ°Makefileä¸­çš„UPROGSï¼›å®ŒæˆåŽï¼Œä½¿ç”¨'make qemu'å°†ç¼–è¯‘ä½ çš„ç¨‹åºï¼Œç„¶åŽä½ å¯ä»¥ä»Žxv6 shellä¸­è¿è¡Œå®ƒã€‚
+ å¦‚æžœç”¨æˆ·å¿˜è®°ä¼ é€’å‚æ•°ï¼Œ'sleep'åº”è¯¥æ‰“å°ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ã€‚
+ å‘½ä»¤è¡Œå‚æ•°ä»¥å­—ç¬¦ä¸²å½¢å¼ä¼ é€’ï¼›ä½ å¯ä»¥ä½¿ç”¨'atoi'å‡½æ•°å°†å…¶è½¬æ¢ä¸ºæ•´æ•°ï¼ˆè¯·å‚é˜…'user/ulib.c'ï¼‰ã€‚
+ ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨'sleep'ã€‚
+ æŸ¥çœ‹xv6å†…æ ¸ä»£ç ä¸­å®žçŽ°'sleep'ç³»ç»Ÿè°ƒç”¨çš„éƒ¨åˆ†ï¼ˆæŸ¥æ‰¾'sys_sleep'ï¼‰ï¼Œåœ¨'user/user.h'ä¸­æŸ¥çœ‹ä»Žç”¨æˆ·ç¨‹åºä¸­å¯è°ƒç”¨'sleep'çš„Cå®šä¹‰ï¼Œä»¥åŠåœ¨'user/usys.S'ä¸­æŸ¥æ‰¾ä»Žç”¨æˆ·ä»£ç è·³è½¬åˆ°å†…æ ¸æ‰§è¡Œ'sleep'çš„æ±‡ç¼–ä»£ç ã€‚
+ 'sleep'çš„'main'å‡½æ•°åœ¨å®Œæˆæ—¶åº”è¯¥è°ƒç”¨'exit(0)'ã€‚
+ æŸ¥çœ‹Kernighanå’ŒRitchieçš„ä¹¦ã€ŠCç¨‹åºè®¾è®¡è¯­è¨€ã€‹ï¼ˆç¬¬äºŒç‰ˆï¼‰ï¼ˆK&Rï¼‰ä»¥äº†è§£æœ‰å…³Cè¯­è¨€çš„çŸ¥è¯†ã€‚

##### ç»“æžœè‡ªæµ‹
sleepå‘½ä»¤æ‰§è¡ŒåŽçš„æ•ˆæžœ
```
$ make qemu
  ...
 init: starting sh
$ sleep 10
(æ— ä»»ä½•è¾“å‡ºæŒç»­ä¸€å°ä¼šï¼‰
$
```


#### å®žéªŒå†…å®¹ 2ï¼šå®žçŽ°findå‘½ä»¤ ï¼ˆðŸ°ðŸ°ï¼‰
ä¸ºxv6å®žçŽ°findå‘½ä»¤ï¼Œç®€åŒ–ç‰ˆçš„ç±»ä¼¼äºŽUNIX 'find' ç¨‹åºï¼ŒæŸ¥æ‰¾å…·æœ‰ç‰¹å®šåç§°çš„ç›®å½•æ ‘ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚

##### æç¤º
+ æŸ¥çœ‹'user/ls.c'ä»¥äº†è§£å¦‚ä½•è¯»å–ç›®å½•ã€‚
+ ä½¿ç”¨é€’å½’æ¥ä½¿'find'èƒ½å¤Ÿè¿›å…¥å­ç›®å½•ã€‚
+ ä¸è¦é€’å½’è¿›å…¥â€œ.â€å’Œâ€œ..â€ã€‚
+ æ–‡ä»¶ç³»ç»Ÿçš„æ›´æ”¹åœ¨qemuè¿è¡Œæ—¶ä¿æŒä¸å˜ï¼›è¦èŽ·å–å¹²å‡€çš„æ–‡ä»¶ç³»ç»Ÿï¼Œè¯·è¿è¡Œ'make clean'ï¼Œç„¶åŽå†è¿è¡Œ'make qemu'ã€‚
+ ä½ éœ€è¦ä½¿ç”¨Cå­—ç¬¦ä¸²ã€‚å‚è€ƒK&Rï¼ˆCè¯­è¨€æ•™æï¼‰ï¼Œä¾‹å¦‚ç¬¬5.5èŠ‚ã€‚
+ è¯·æ³¨æ„ï¼Œ'=='ä¸åƒPythonä¸­é‚£æ ·æ¯”è¾ƒå­—ç¬¦ä¸²ã€‚åº”ä½¿ç”¨'strcmp()'ä»£æ›¿ã€‚
+ å°†ç¨‹åºæ·»åŠ åˆ°Makefileä¸­çš„UPROGSã€‚

##### ç»“æžœè‡ªæµ‹
```
$ make qemu
...
init: starting sh
$ echo > b
$ mkdir a
$ echo > a/b
$ mkdir a/aa
$ echo > a/aa/b
$ find . b
./b
./a/b
./a/aa/b
$
```