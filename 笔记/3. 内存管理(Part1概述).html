<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    pre {
        page-break-inside: avoid;
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}



mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG2"] path[data-c], mjx-container[jax="SVG2"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}
mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
							stroke-width: 0;
						}
</style><title>3. 内存管理(Part1概述)</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='1-内存管理基础'><font color='cornflowerblue'><span>1. 内存管理基础</span></font></h1><blockquote><h2 id='11-概述'><font color='cornflowerblue'><span>1.1. 概述</span></font></h2><blockquote><h3 id='111-内存管理的功能'><font color='orange'><span>1.1.1. 内存管理的功能</span></font></h3><blockquote><p>1️⃣<span>分配回收内存：记住内存使用情况，内存分配，回收用户释放的内存</span></p><p>2️⃣<span>地址变换：程序的逻辑地址</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.462ex" height="1.242ex" role="img" focusable="false" viewBox="0 -525 2414 549" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.054ex;"><defs><path id="MJX-12-TEX-N-27FA" d="M1438 514Q1438 525 1454 525Q1459 525 1462 525T1467 525T1471 524T1473 523T1475 520T1477 517T1480 512Q1517 438 1578 381T1689 300T1785 263Q1802 258 1802 250T1793 239T1756 228T1698 204Q1554 134 1480 -12Q1476 -21 1473 -22T1458 -24Q1438 -24 1438 -17Q1438 -13 1443 0Q1478 69 1529 123L1539 133H318L328 123Q379 69 414 0Q419 -13 419 -17Q419 -24 399 -24Q388 -24 385 -23T377 -12Q332 77 253 144T72 237Q62 240 59 242T56 250T59 257T70 262T89 268T119 278T160 296Q303 366 377 512Q382 522 385 523T401 525Q419 524 419 515Q419 510 414 500Q379 431 328 377L318 367H1539L1529 377Q1496 412 1467 458T1438 514ZM274 173H1583L1593 181Q1632 211 1710 250Q1709 251 1692 259T1647 283T1593 319L1583 327H930L927 328L602 327H274L264 319Q225 289 147 250Q148 249 165 241T210 217T264 181L274 173Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="mspace"></g></g><g data-mml-node="mo" transform="translate(278,0)"><use data-c="27FA" xlink:href="#MJX-12-TEX-N-27FA"></use></g><g data-mml-node="mstyle" transform="translate(2136,0)"><g data-mml-node="mspace"></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle scriptlevel="0"><mspace width="0.278em"></mspace></mstyle><mo stretchy="false">⟺</mo><mstyle scriptlevel="0"><mspace width="0.278em"></mspace></mstyle></math></mjx-assistive-mml></mjx-container><script type="math/tex">\iff</script><span>内存的物理地址</span></p><p>3️⃣<span>扩充内容：基于逻辑层面的虚存技术</span></p><p>4️⃣<span>存储保护：使各道作业在内存中独立运行，且不破坏系统程序</span></p></blockquote><h3 id='112-其他背景知识'><font color='cornflowerblue'><span>1.1.2. 其他背景知识</span></font></h3><blockquote><p>1️⃣<span>程序执行的必要条件：输入内存，放入一个进程</span></p><p>2️⃣<span>输入队列：磁盘上等待进入内存并执行的进程集合</span></p><p>3️⃣<span>程序的加载：将程序代码/数据从磁盘读入内存，并准备开始执行</span></p><p>4️⃣<span>动态加载：一个程序只有在调用时才会加载</span></p></blockquote></blockquote><h2 id='12-程序的加载'><font color='cornflowerblue'><span>1.2. 程序的加载</span></font></h2><blockquote><h3 id='121-概览编译-链接-装入'><font color='cornflowerblue'><span>1.2.1. 概览：编译-链接-装入</span></font></h3><blockquote><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231022010612046.png" alt="image-20231022010612046" style="zoom: 67%;" /><span> </span></p></blockquote><h3 id='122-地址变换'><font color='cornflowerblue'><span>1.2.2. 地址变换</span></font></h3><blockquote><p><img src="https://s2.loli.net/2023/11/07/dO96ozvpSmjTatx.png" alt="image-20211028143020575" style="zoom: 33%;" /><span> </span></p><p>1️⃣<span>符号地址(对源程序而言)：编程中用变量/数据名指定的位置</span></p><p>2️⃣<span>相对/虚拟/逻辑地址(对目标程序而言)：源程序编译后CPU生成的目标代码地址，从0开始</span></p><p>3️⃣<span>物理/绝对地址(对可执行程序而言)：程序加载后在内存的实际地址</span></p><p><span>PS—逻辑地址对用户可见，物理地址对用户透明</span></p></blockquote><h3 id='123-重定位虚拟地址→物理地址'><font color='cornflowerblue'><span>1.2.3. 重定位：虚拟地址→物理地址</span></font></h3><blockquote><p>1️⃣<span>静态重定位：在装入时，逻辑地址全部转为绝对的地址，执行过程中不变</span></p><p><img src="https://s2.loli.net/2023/11/07/ZEYFNXwDRUb1PxB.png" alt="image-20231107151641464" style="zoom: 67%;" /><span> </span></p><p>2️⃣<span>动态重定位：起始地址放入重定位寄存器，执行过程中，在CPU访问内存前，把要访问的数据/程序地址转化为内存地址(硬件实现：重定位寄存器+逻辑地址-&gt;物理地址)</span></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231022120923715.png" alt="image-20231022120923715" style="zoom:67%;" /><span> </span></p></blockquote><h3 id='123-三种链接'><font color='cornflowerblue'><span>1.2.3. 三种链接</span></font></h3><blockquote><p>1️⃣<span>静态链接：全部链接完再运行</span></p><p>2️⃣<span>装入时动态链接：边装入边链接</span></p><p>3️⃣<span>动态链接：一部分先运行，等需要某些块了再链接+装入，节省了内存(不需要的块就不装入了)</span></p></blockquote><h3 id='124-三种装入对应编译装入执行时绑定到内存地址'><font color='cornflowerblue'><span>1.2.4. 三种装入：对应编译/装入/执行时绑定到内存地址</span></font></h3><blockquote><p>1️⃣<span>绝对装入：编译时生成绝对代码(含物理地址)，决定了要装内存哪</span></p><p>2️⃣<span>可重定位装入：装入时完成地址变换(物理地址=基地址+逻辑地址)，实现容易但程序地址要连续</span></p><p>3️⃣<span>动态运行装入：程序运行时在内存中位移，程序运行某指令/访问某数据后才装入，地址可不连续</span></p></blockquote></blockquote><h2 id='13-内存保护防止一个作业破坏另一个'><font color='orange'><span>1.3. 内存保护：防止一个作业破坏另一个</span></font></h2><blockquote><p>1️⃣<span>界限寄存器法</span></p><ol start='' ><li><p><span>上下界寄存器法：让上/下界寄存器分别存储作业的开始/结束地址，如果作业运行时访问的内存超出这个上下界就立马中断</span></p></li><li><p><font color='cornflowerblue'><span>基址+限长寄存器法：分别存放作业的起始地址+作业长度，限长寄存器与相对地址进行比较超出就立马中断</span></font></p></li></ol><p>2️⃣<span>存储保护键方法：若干分区中每个分区有很多存储块，给每个存储块分配一个单独的保护键(锁)。进入系统的作业被赋予一个保护键(钥匙)，然后检查二者保护键是否匹配，不匹配就立即中断</span></p></blockquote><h2 id='14-覆盖交换技术'><font color='cornflowerblue'><span>1.4. 覆盖&amp;交换技术</span></font></h2><blockquote><h3 id='141-覆盖技术把大程序分为一系列覆盖'><font color='orange'><span>1.4.1. 覆盖技术：把大程序分为一系列覆盖</span></font></h3><blockquote><p><span>见于早期小内存OS</span></p><p>1️⃣<span>基本概念</span></p><ol start='' ><li><p><span>覆盖：程序中相对独立的程序单位</span></p></li><li><p><span>覆盖段：程序执行时不需要同时装入内存的一组覆盖</span></p></li><li><p><span>覆盖区：与覆盖段一一对应的存储区域，将覆盖段分配到一个覆盖区。覆盖区的大小=覆盖段中最大覆盖的大小</span></p></li></ol><p>2️⃣<span>覆盖实例：一般都是由程序员提供覆盖结构</span></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231022150828445.png" alt="image-20231022150828445" style="zoom:67%;" /><span> </span></p></blockquote><h3 id='142-内存交换扩展'><font color='cornflowerblue'><span>1.4.2. 内存交换(扩展)</span></font></h3><blockquote><p>1️⃣<span>概述：把暂不用的程序/数据从内存移到外存(或移回来)</span></p><p>2️⃣<span>兼容分时系统：内存中只有一完整作业，时间片用完后OS就把他丢到外存，放外存中另一作业来</span></p><p>3️⃣<span>与覆盖技术的比较</span></p><ol start='' ><li><p><span>覆盖要求程序员给出程序段之间的覆盖结构，交换不需要</span></p></li><li><p><span>交换发生在不同进程/作业之间，覆盖发生于用一进程/作业</span></p></li></ol><p>4️⃣<span>交换技术的特点</span></p><ol start='' ><li><p><span>从主存交换到什么设备：快速+空间够+直接访问，比如SSD</span></p></li><li><p><span>从主存交换到哪里：</span><font color='red'><span>交换空间</span></font><span>(aka</span><font color='red'><span>备份区</span></font><span>，大小固定，独立于文件系统，可直接存取)</span></p></li><li><p><span>什么进程被交换：优先级低的被交换出去(进程要空闲即休眠/不占CPU)，高的被交换进来</span></p></li><li><p><span>转移时间：交换耗时，应该远低于进程执行时长</span></p></li><li><p><span>合适交换：内存爆满</span></p></li></ol><p>5️⃣<span>挂起与交换：挂起进程会被丢到外存</span></p></blockquote></blockquote><h2 id='15-连续分配-程序装入连续内存'><font color='cornflowerblue'><span>1.5. 连续分配: 程序装入连续内存</span></font></h2><blockquote><h3 id='150-内部外部碎片'><font color='cornflowerblue'><span>1.5.0. 内部/外部碎片</span></font></h3><blockquote><p>1️⃣<span>内部碎片：已分给作业但不能被利用的内存(某个作业占用内存中没填满的部分)</span></p><p>2️⃣<span>外部碎片：由于太小而无法分配给作业的内存碎片(不同作业之间剩余的内存)</span></p></blockquote><h3 id='151-单一连续分配单任务os'><font color='cornflowerblue'><span>1.5.1. 单一连续分配：单任务OS</span></font></h3><blockquote><p>1️⃣<span>内存结构：低地址给OS，高地址给用户，再其余的浪费掉</span></p><p><img src="https://s2.loli.net/2023/11/08/7SbU9tqZREAkG8I.png" alt="image-20211222144348943" style="zoom:50%;" /><span> </span></p><p>2️⃣<span>缺点：会产生内部碎片</span></p></blockquote><h3 id='152-多分区分配固定静态分区早期'><font color='cornflowerblue'><span>1.5.2. 多分区分配：固定/静态分区(早期)</span></font></h3><blockquote><p>1️⃣<span>概述：OS分区+多个用户分区，用户分区大小在装入前预先确定，每个分区装一个程序</span></p><p><span>PS1：分区大小可以相等也可以不等</span></p><p><span>PS2：会产生内部碎片且分区有限，但是易于实现开销小</span></p><p>2️⃣<span>分区说明表：记录可分配的区号(及其大小/起止)，程序装入内存时检索一次分区表找出满足要求的空闲分区</span></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231022160820398.png" alt="image-20231022160820398" style="zoom:67%;" /><span> </span></p></blockquote><h3 id='153-多分区分配动态分区'><font color='cornflowerblue'><span>1.5.3. 多分区分配：动态分区</span></font></h3><blockquote><h4 id='1531-概述'><font color='cornflowerblue'><span>1.5.3.1. 概述</span></font></h4><blockquote><p>1️⃣<span>含义：作业进入主存时，再建立分区</span></p><p>2️⃣<span>分区大小=作业大小：</span></p><ol start='' ><li><p><span>作业进入主存时查找大于等于作业大小的空闲分区</span></p></li><li><p><span>等于的话直接分配</span></p></li><li><p><span>大于的话分成两半——和作业一样大的(占用)+剩余部分(空闲)</span></p></li></ol><p>3️⃣<span>存在外碎片</span></p></blockquote><h4 id='1532-分区分配中的数据结构'><font color='orange'><span>1.5.3.2. 分区分配中的数据结构</span></font></h4><blockquote><p>1️⃣<span>空闲分区表：登记空闲的分区，一个分区对应一项，一项中有分区号/大小/起始/状态</span></p><p><span>PS：内存从低到高——分区号从小到大</span></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231022162617309.png" alt="image-20231022162617309" style="zoom: 60%;" /><span> </span></p><p>2️⃣<span>空闲分区链：用指针链接所有空闲分区</span></p><p><span>PS：每空闲分区起始位，存放空闲分区大小+指向下一空闲分区指针</span></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231022163249910.png" alt="image-20231022163249910" style="zoom: 67%;" /><span> </span></p></blockquote><h4 id='1533-分区分配算法怎样把空闲区分给作业'><font color='cornflowerblue'><span>1.5.3.3. 分区分配算法：怎样把空闲区分给作业</span></font></h4><blockquote><p>1️⃣<span>首次适应算法：</span></p><ol start='' ><li><p><span>含义：在空闲分区链中从头按顺序找，选找到的第一个大小合适的空闲区</span></p></li><li><p><span>优点：分配/释放速度快</span></p></li><li><p><span>缺点是：低地址空闲块会越分越小，导致之后的查找成本大</span></p></li></ol><p>2️⃣<font color='orange'><span>下次适应算法</span></font><span>：</span></p><ol start='' ><li><p><span>基于首次适应的改进：空闲分区链改为循环链表，每次从上次停留地方开始找，</span></p></li><li><p><span>缺点：全局都难有大的空闲区</span></p></li></ol><p>3️⃣<span>最佳适应算法：</span></p><ol start='' ><li><p><span>含义：空闲区从小到大排列，每次从小到大一个个试，试到差不多大小的块便分给进程</span></p></li><li><p><span>缺点：会产生很多难以利用的碎片，除非用碎片拼接(aka紧凑)</span></p></li></ol><p>4️⃣<font color='orange'><span>最差适应算法</span></font><span>：</span></p><ol start='' ><li><p><span>含义：空闲分区按照容量大到小排列，最大空闲分区优先分配</span></p></li><li><p><span>缺点：大作业来到时，大空闲区已经被优先分配掉了</span></p></li></ol></blockquote><h4 id='1534-分区回收'><font color='cornflowerblue'><span>1.5.3.4. 分区回收</span></font></h4><blockquote><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231022200615706.png" alt="image-20231022200615706" style="zoom:50%;" /><span> </span></p><p>1️⃣<span>回收区上/下邻接空闲区：合为一空闲区，首地址为顶上那个</span></p><p>2️⃣<span>回收区上下邻接空闲区：合为一大空闲区，从链表中删除下面的分区</span></p><p>3️⃣<span>回收区上下无空闲区：独立为空闲区，加入空闲分区链表Z</span></p></blockquote><h4 id='1534-如何处理碎片'><font color='cornflowerblue'><span>1.5.3.4. 如何处理碎片？</span></font></h4><blockquote><p>1️⃣<span>核心问题：作业装入的内存要连续，但内存碎片总和总是大于作业大小</span></p><p>2️⃣<span>拼接技术(紧缩)：</span></p><ol start='' ><li><p><span>含义：向一个方向移动已分配的作业，碎片就此紧缩在另一端</span></p></li><li><p><span>何时紧缩？：某个分区回收时(频率高)，找不到足够空间时(频率低但是实现复杂)</span></p></li></ol><p>3️⃣<span>动态分区分配+拼接→动态重定位分区分配：空闲区不够，但碎片总和够大时实行分区</span></p></blockquote></blockquote></blockquote><h2 id='16-非连续分配概述程序装入非连续内存'><font color='orange'><span>1.6. 非连续分配概述：程序装入非连续内存</span></font></h2><blockquote><p>1️⃣<span>核心：把程序打散存在主存里，然后用索引将其联系起来</span></p><p>2️⃣<span>分类</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="txt"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="txt"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51562px; left: 36px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -28px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">├── 分区大小不定：分段存储管理</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">├── 分区大小固定：分页存储管理</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ├── 运行时把作业所有页装入内存：基本分页存储管理</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ├── 运行时把作业部分页装入内存：请求分页存储管理(见后虚拟存储)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="height: 92px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre></blockquote><h2 id='17-基本分页存储管理'><font color='cornflowerblue'><span>1.7. 基本分页存储管理</span></font></h2><blockquote><h3 id='171-分页以页表地址变换'><font color='cornflowerblue'><span>1.7.1. 分页以&amp;页表&amp;地址变换</span></font></h3><blockquote><h4 id='1711-简单分页纯分页原理'><font color='cornflowerblue'><span>1.7.1.1. 简单分页/纯分页原理</span></font></h4><blockquote><p>1️⃣<span>页&amp;块</span></p><ol start='' ><li><p><span>页：作业中等大的逻辑内存空间</span></p></li><li><p><span>块/帧：主存中，大小固定的物理内存空间，大小上块和页相等的</span></p></li><li><p><span>页框：主存中大小与页一样大的块</span></p></li></ol><p>2️⃣<span>作业调度：以块为单位，将作业任一页丢到主存任一块，所有页要一次调入(块不够就等待)</span></p><p>3️⃣<span>页/块大小的决定：</span></p><ol start='' ><li><p><span>过大会导致碎片太多，过小会导致页表过长(占用内存)+页面进出主存效率低</span></p></li><li><p><span>通常为2幂大小，512B-4KB</span></p></li></ol><p>4️⃣<span>逻辑地址结构：[页号] [页内位移]，如下有</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="9.445ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 4174.7 915.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.186ex;"><defs><path id="MJX-10-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-10-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-10-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-10-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-10-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-10-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-10-TEX-N-32"></use><use data-c="30" xlink:href="#MJX-10-TEX-N-30" transform="translate(500,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(1567.9,0)"><use data-c="3D" xlink:href="#MJX-10-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(2623.7,0)"><use data-c="31" xlink:href="#MJX-10-TEX-N-31"></use></g><g data-mml-node="mi" transform="translate(3123.7,0)"><use data-c="1D440" xlink:href="#MJX-10-TEX-I-1D440"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mn>20</mn></mrow></msup><mo>=</mo><mn>1</mn><mi>M</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">2^{20}=1M</script><span>页+每页</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="9.078ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 4012.7 915.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.186ex;"><defs><path id="MJX-11-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-11-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-11-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-11-TEX-N-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path id="MJX-11-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-11-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-11-TEX-N-31"></use><use data-c="32" xlink:href="#MJX-11-TEX-N-32" transform="translate(500,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(1567.9,0)"><use data-c="3D" xlink:href="#MJX-11-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(2623.7,0)"><use data-c="34" xlink:href="#MJX-11-TEX-N-34"></use></g><g data-mml-node="mi" transform="translate(3123.7,0)"><use data-c="1D43E" xlink:href="#MJX-11-TEX-I-1D43E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mn>12</mn></mrow></msup><mo>=</mo><mn>4</mn><mi>K</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">2^{12}=4K</script><span>大小</span></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231022213158583.png" alt="image-20231022213158583" style="zoom: 67%;" /><span> </span></p><p><span>这两个参数都由CPU生成，存在如下关系</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="txt"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="txt"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51562px; left: 36px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>2</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -28px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">(int)[逻辑地址]/[页面大小]=[页号]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">(int)[逻辑地址]%[页面大小]=[页内位移]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre></blockquote><h4 id='1712-页表-用户程序的页页号-⟺-块号主存物理块'><font color='cornflowerblue'><span>1.7.1.2. 页表: (用户程序的页)页号</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.462ex" height="1.242ex" role="img" focusable="false" viewBox="0 -525 2414 549" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.054ex;"><defs><path id="MJX-12-TEX-N-27FA" d="M1438 514Q1438 525 1454 525Q1459 525 1462 525T1467 525T1471 524T1473 523T1475 520T1477 517T1480 512Q1517 438 1578 381T1689 300T1785 263Q1802 258 1802 250T1793 239T1756 228T1698 204Q1554 134 1480 -12Q1476 -21 1473 -22T1458 -24Q1438 -24 1438 -17Q1438 -13 1443 0Q1478 69 1529 123L1539 133H318L328 123Q379 69 414 0Q419 -13 419 -17Q419 -24 399 -24Q388 -24 385 -23T377 -12Q332 77 253 144T72 237Q62 240 59 242T56 250T59 257T70 262T89 268T119 278T160 296Q303 366 377 512Q382 522 385 523T401 525Q419 524 419 515Q419 510 414 500Q379 431 328 377L318 367H1539L1529 377Q1496 412 1467 458T1438 514ZM274 173H1583L1593 181Q1632 211 1710 250Q1709 251 1692 259T1647 283T1593 319L1583 327H930L927 328L602 327H274L264 319Q225 289 147 250Q148 249 165 241T210 217T264 181L274 173Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="mspace"></g></g><g data-mml-node="mo" transform="translate(278,0)"><use data-c="27FA" xlink:href="#MJX-12-TEX-N-27FA"></use></g><g data-mml-node="mstyle" transform="translate(2136,0)"><g data-mml-node="mspace"></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle scriptlevel="0"><mspace width="0.278em"></mspace></mstyle><mo stretchy="false">⟺</mo><mstyle scriptlevel="0"><mspace width="0.278em"></mspace></mstyle></math></mjx-assistive-mml></mjx-container><script type="math/tex">\iff</script><span>块号(主存物理块)</span></font></h4><blockquote><p>1️⃣<span>概览：页表存在内存中，如图例子。页表项=页号+块号+其他(存在位/修改/访问权限)</span></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231022214501879.png" alt="image-20231022214501879" style="zoom: 50%;" /><span> </span></p><p>2️⃣<span>有效-无效位：在页表表项中，有效表示有关页在进程的逻辑地址空间中</span></p><p><img src="https://s2.loli.net/2023/11/09/HmRaDLfWbthACyn.png" alt="image-20211102165311715" style="zoom: 90%;" /><span> </span></p></blockquote><h4 id='1713-基本地址变换机构-基于硬件'><font color='cornflowerblue'><span>1.7.1.3. 基本地址变换机构: 基于硬件</span></font></h4><blockquote><p><img src="https://s2.loli.net/2023/11/09/KWYaUvcstN5ieVz.png" alt="image-20231109211401402" style="zoom: 67%;" /><span> </span></p><p>1️⃣<span>页表寄存器(PTR)：</span><strong><span>页表基址寄存器</span></strong><span>(主存中的页表起始地址)+</span><strong><span>页表限长寄存器</span></strong><span>(页表长度)</span></p><p>2️⃣<span>逻辑地址→物理地址</span></p><ol start='' ><li><p><span>计算出页号和页内位移</span></p></li></ol><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="txt"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="txt"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51562px; left: 36px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>2</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -28px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">(int)[逻辑地址]/[页面大小]=[页号]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">(int)[逻辑地址]%[页面大小]=[页内位移]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><ol start='2' ><li><p><span>若页号&gt;页表长度则越界终中断</span></p></li><li><p><span>页表起始地址+偏移量(页号*页表每项长度)→得到地址，从该地址取出物理块号</span></p></li><li><p><span>物理块号+页内位移(=块内位移)→物理地址</span></p></li></ol><p>3️⃣<span>弊端：存取数据/变量要访问两次主存(第一次访问页表确定物理地址+第二次用物理地址访问指令or数据)，快表可以解决这一问题</span></p></blockquote></blockquote><h3 id='172-其他类型的页表'><font color='cornflowerblue'><span>1.7.2. 其他类型的页表</span></font></h3><blockquote><h4 id='1721-具有快表的地址变换机构'><font color='cornflowerblue'><span>1.7.2.1. 具有快表的地址变换机构</span></font></h4><blockquote><p>1️⃣<span>快表：储存作业当前/近期访问的页表项，类似于Cache</span></p><p>2️⃣<span>联想寄存器TLB：存储块表的寄存器</span></p><p>2️⃣<span>改进后逻辑地址→物理地址</span></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231022224109094.png" alt="image-20231022224109094" style="zoom:67%;" /><span> </span></p><ol start='' ><li><p><span>求出页号+页内位移</span></p></li><li><p><span>先把页号和快表中的对比，对上了就得到对应块号，与页内位移组合成物理地址</span></p></li><li><p><span>否则就和原来一样</span></p></li></ol></blockquote><h4 id='1722-两级页表'><font color='cornflowerblue'><span>1.7.2.2. 两级页表</span></font></h4><blockquote><p>1️⃣<span>页表大小计算：页表长度(页表项目数)*页表每项大小(块号位数)</span></p><p>2️⃣<span>背景：</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="16.076ex" height="2.474ex" role="img" focusable="false" viewBox="0 -893.3 7105.6 1093.3" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.452ex;"><defs><path id="MJX-13-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-13-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">页</text></g><g data-mml-node="mtext" transform="translate(884,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">表</text></g><g data-mml-node="mtext" transform="translate(1778.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">长</text></g><g data-mml-node="mo" transform="translate(2951.3,0)"><use data-c="3D" xlink:href="#MJX-13-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(4007.1,0)"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-13-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">页</text></g><g data-mml-node="mtext" transform="translate(884,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">号</text></g><g data-mml-node="mtext" transform="translate(1768,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mtext" transform="translate(2662.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">数</text></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>页</mtext><mtext>表</mtext><mtext>长</mtext><mo>=</mo><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mtext>页</mtext><mtext>号</mtext><mtext>位</mtext><mtext>数</mtext></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">页表长=2^{页号位数}</script><span>，页表长度爆炸式增长→占空间太大</span></p><p>3️⃣<span>两级页表逻辑地址</span></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231022230019503.png" alt="image-20231022230019503" style="zoom: 67%;" /><span> </span></p><p>4️⃣<span>地址变换过程：</span></p><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="79.634ex" height="5.146ex" role="img" focusable="false" viewBox="0 -1359.7 35198.1 2274.4" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -2.069ex;"><defs><path id="MJX-14-TEX-S4-2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path><path id="MJX-14-TEX-S4-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-14-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-14-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-14-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">外</text></g><g data-mml-node="mtext" transform="translate(884,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">层</text></g><g data-mml-node="mtext" transform="translate(1768,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">页</text></g><g data-mml-node="mtext" transform="translate(2652,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">号</text></g><g data-mml-node="mover" transform="translate(3813.8,0)"><g data-mml-node="mstyle"><g data-mml-node="mo"><use data-c="2192" xlink:href="#MJX-14-TEX-S4-2192" transform="translate(3339.5,0)"></use><svg width="3439.5" height="865" x="0" y="-182" viewBox="859.9 -182 3439.5 865"><use data-c="2212" xlink:href="#MJX-14-TEX-S4-2212" transform="scale(6.631,1)"></use></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">在</text></g><g data-mml-node="mtext" transform="translate(884,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">外</text></g><g data-mml-node="mtext" transform="translate(1768,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">部</text></g><g data-mml-node="mtext" transform="translate(2652,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">页</text></g><g data-mml-node="mtext" transform="translate(3536,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">找</text></g><g data-mml-node="mtext" transform="translate(4420,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">到</text></g><g data-mml-node="mspace" transform="translate(5304,0)"></g></g></g></g><g data-mml-node="mtext" transform="translate(8431.1,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">二</text></g><g data-mml-node="mtext" transform="translate(9315.1,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">级</text></g><g data-mml-node="mtext" transform="translate(10199.1,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">页</text></g><g data-mml-node="mtext" transform="translate(11083.1,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">表</text></g><g data-mml-node="mtext" transform="translate(11977.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">首</text></g><g data-mml-node="mtext" transform="translate(12861.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">地</text></g><g data-mml-node="mtext" transform="translate(13756.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">址</text></g><g data-mml-node="munderover" transform="translate(14929.1,0)"><g data-mml-node="mstyle"><g data-mml-node="mo"><use data-c="2192" xlink:href="#MJX-14-TEX-S4-2192" transform="translate(3904.9,0)"></use><svg width="4004.9" height="865" x="0" y="-182" viewBox="1001.2 -182 4004.9 865"><use data-c="2212" xlink:href="#MJX-14-TEX-S4-2212" transform="scale(7.721,1)"></use></svg></g></g><g data-mml-node="mpadded" transform="translate(1529,-779.3) scale(0.707)"><g transform="translate(278,150)"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">得</text></g><g data-mml-node="mtext" transform="translate(894.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">到</text></g><g data-mml-node="mspace" transform="translate(1778.8,0)"></g></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mo"><use data-c="2B" xlink:href="#MJX-14-TEX-N-2B"></use></g><g data-mml-node="mtext" transform="translate(778,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">外</text></g><g data-mml-node="mtext" transform="translate(1662,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">层</text></g><g data-mml-node="mtext" transform="translate(2546,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">页</text></g><g data-mml-node="mtext" transform="translate(3430,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">内</text></g><g data-mml-node="mtext" transform="translate(4314,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">地</text></g><g data-mml-node="mtext" transform="translate(5208.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">址</text></g><g data-mml-node="mspace" transform="translate(6103.5,0)"></g></g></g></g><g data-mml-node="mtext" transform="translate(20111.7,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">物</text></g><g data-mml-node="mtext" transform="translate(20995.7,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">理</text></g><g data-mml-node="mtext" transform="translate(21890.5,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">块</text></g><g data-mml-node="mo" transform="translate(22785.3,0)"><use data-c="28" xlink:href="#MJX-14-TEX-N-28"></use></g><g data-mml-node="mtext" transform="translate(23174.3,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">首</text></g><g data-mml-node="mo" transform="translate(24058.3,0)"><use data-c="29" xlink:href="#MJX-14-TEX-N-29"></use></g><g data-mml-node="mtext" transform="translate(24447.3,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">地</text></g><g data-mml-node="mtext" transform="translate(25342,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">址</text></g><g data-mml-node="munderover" transform="translate(26514.5,0)"><g data-mml-node="mstyle"><g data-mml-node="mo"><use data-c="2192" xlink:href="#MJX-14-TEX-S4-2192" transform="translate(3837.5,0)"></use><svg width="3937.5" height="865" x="0" y="-182" viewBox="984.4 -182 3937.5 865"><use data-c="2212" xlink:href="#MJX-14-TEX-S4-2212" transform="scale(7.592,1)"></use></svg></g></g><g data-mml-node="mpadded" transform="translate(1495.4,-779.3) scale(0.707)"><g transform="translate(278,150)"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">得</text></g><g data-mml-node="mtext" transform="translate(894.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">到</text></g><g data-mml-node="mspace" transform="translate(1778.8,0)"></g></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mo"><use data-c="2B" xlink:href="#MJX-14-TEX-N-2B"></use></g><g data-mml-node="mtext" transform="translate(778,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">页</text></g><g data-mml-node="mo" transform="translate(1662,0)"><use data-c="28" xlink:href="#MJX-14-TEX-N-28"></use></g><g data-mml-node="mtext" transform="translate(2051,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">块</text></g><g data-mml-node="mo" transform="translate(2945.8,0)"><use data-c="29" xlink:href="#MJX-14-TEX-N-29"></use></g><g data-mml-node="mtext" transform="translate(3334.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">内</text></g><g data-mml-node="mtext" transform="translate(4218.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">地</text></g><g data-mml-node="mtext" transform="translate(5113.5,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">址</text></g><g data-mml-node="mspace" transform="translate(6008.3,0)"></g></g></g></g><g data-mml-node="mtext" transform="translate(31629.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">物</text></g><g data-mml-node="mtext" transform="translate(32513.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">理</text></g><g data-mml-node="mtext" transform="translate(33408.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">地</text></g><g data-mml-node="mtext" transform="translate(34303.3,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">址</text></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>外</mtext><mtext>层</mtext><mtext>页</mtext><mtext>号</mtext><mover><mstyle scriptlevel="0"><mo data-mjx-texclass="REL">→</mo></mstyle><mpadded width="+0.833em" lspace="0.278em" voffset="-.2em" height="-.2em"><mtext>在</mtext><mtext>外</mtext><mtext>部</mtext><mtext>页</mtext><mtext>找</mtext><mtext>到</mtext><mspace depth=".25em"></mspace></mpadded></mover><mtext>二</mtext><mtext>级</mtext><mtext>页</mtext><mtext>表</mtext><mtext>首</mtext><mtext>地</mtext><mtext>址</mtext><munderover><mstyle scriptlevel="0"><mo data-mjx-texclass="REL">→</mo></mstyle><mpadded width="+0.833em" lspace="0.278em" voffset=".15em" depth="-.15em"><mtext>得</mtext><mtext>到</mtext><mspace height=".75em"></mspace></mpadded><mpadded width="+0.833em" lspace="0.278em" voffset="-.2em" height="-.2em"><mo>+</mo><mtext>外</mtext><mtext>层</mtext><mtext>页</mtext><mtext>内</mtext><mtext>地</mtext><mtext>址</mtext><mspace depth=".25em"></mspace></mpadded></munderover><mtext>物</mtext><mtext>理</mtext><mtext>块</mtext><mo stretchy="false">(</mo><mtext>首</mtext><mo stretchy="false">)</mo><mtext>地</mtext><mtext>址</mtext><munderover><mstyle scriptlevel="0"><mo data-mjx-texclass="REL">→</mo></mstyle><mpadded width="+0.833em" lspace="0.278em" voffset=".15em" depth="-.15em"><mtext>得</mtext><mtext>到</mtext><mspace height=".75em"></mspace></mpadded><mpadded width="+0.833em" lspace="0.278em" voffset="-.2em" height="-.2em"><mo>+</mo><mtext>页</mtext><mo stretchy="false">(</mo><mtext>块</mtext><mo stretchy="false">)</mo><mtext>内</mtext><mtext>地</mtext><mtext>址</mtext><mspace depth=".25em"></mspace></mpadded></munderover><mtext>物</mtext><mtext>理</mtext><mtext>地</mtext><mtext>址</mtext></math></mjx-assistive-mml></mjx-container><script type="math/tex">外层页号\xrightarrow{在外部页找到}二级页表首地址\xrightarrow[得到]{+外层页内地址}物理块(首)地址\xrightarrow[得到]{+页(块)内地址}物理地址</script></p><p>➕<span>多级页表：逻辑和两级页表一样，多见于64位系统，缺点是地址变换耗费资源</span></p></blockquote><h4 id='1723-hash页表'><font color='cornflowerblue'><span>1.7.2.3. HASH页表</span></font></h4><blockquote><p><span>通过哈希表来完成逻辑地址到物理地址的映射</span></p><p><img src="https://s2.loli.net/2023/11/09/wzaPQUy9NEqBjWV.png" alt="image-20211102171917982" style="zoom:67%;" /><span> </span></p></blockquote><h4 id='1724-反转页表'><span>1.7.2.4. 反转页表</span></h4><blockquote><p>1️⃣<span>背景：传统上</span><font color='red'><span>每个进程设一张页表</span></font><span>，浪费内存</span></p><p>2️⃣<span>解决方案：页表按物理内存块组织(而非进程)，反转页表中</span><strong><span>包含了内存中所有物理块地址→其逻辑的地址的映射</span></strong></p><p>3️⃣<span>关于表项：</span></p><ol start='' ><li><p><span>内存中每一块在表中占一项</span></p></li><li><p><span>每项包含：进程逻辑页号(存储在物理内存中)+进程标识</span></p></li><li><p><span>使用HASH表来搜索表项</span></p></li></ol><p>4️⃣<span>特点：减少了页表占用空间，但查找时间增加</span></p></blockquote></blockquote><h3 id='173-页的共享与保护'><font color='cornflowerblue'><span>1.7.3. 页的共享与保护</span></font></h3><blockquote><p>1️⃣<span>分页中共享的实现：</span><font color='red'><span>共享用户地址空间中的页指向相同的物理块</span></font></p><p>2️⃣<span>分页中的保护：</span></p><ol start='' ><li><p><span>地址越界保护：比较地址变换机构中的页表长度和逻辑地址中的页号</span></p></li><li><p><span>访问控制：程序访问一个页面时，OS检查该操作是否有权限(只读/只写/可执行)，无权就中断</span></p></li></ol></blockquote><h3 id='174-基本分页存储管理的利弊'><font color='cornflowerblue'><span>1.7.4. 基本分页存储管理的利弊</span></font></h3><blockquote><p>1️⃣<span>利：内存利用率高+离散分配+便于存储访问控制+无外部碎片</span></p><p>2️⃣<span>弊：需要硬件支持(如快表)+内存访问效率低+共享困难(对比分段)+有内部碎片</span></p></blockquote></blockquote><h2 id='18-基本分段存储管理'><font color='cornflowerblue'><span>1.8. 基本分段存储管理</span></font></h2><blockquote><p><span>页是信息的储存单位，段是信息的逻辑单位</span></p><h3 id='181-分段存储原理'><font color='orange'><span>1.8.1. 分段存储原理</span></font></h3><blockquote><p>1️⃣<span>作业&amp;内存分段：每个分段都有段名，每段地址从0开始，每段的地址连续(段间可不连续)</span></p><p>2️⃣<span>分段存储的逻辑地址结构：段数=</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="7.027ex" height="2.021ex" role="img" focusable="false" viewBox="0 -893.3 3106.1 893.3" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-15-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-15-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">段</text></g><g data-mml-node="mtext" transform="translate(894.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">号</text></g><g data-mml-node="mtext" transform="translate(1778.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mtext" transform="translate(2673.5,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">数</text></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mtext>段</mtext><mtext>号</mtext><mtext>位</mtext><mtext>数</mtext></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">2^{段号位数}</script><span>，段长=</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="9.873ex" height="2.021ex" role="img" focusable="false" viewBox="0 -893.3 4363.9 893.3" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-16-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-16-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">段</text></g><g data-mml-node="mtext" transform="translate(894.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">内</text></g><g data-mml-node="mtext" transform="translate(1778.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mtext" transform="translate(2673.5,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">移</text></g><g data-mml-node="mtext" transform="translate(3557.5,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mtext" transform="translate(4452.3,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">数</text></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mtext>段</mtext><mtext>内</mtext><mtext>位</mtext><mtext>移</mtext><mtext>位</mtext><mtext>数</mtext></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">2^{段内位移位数}</script></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231023104710698.png" alt="image-20231023104710698" style="zoom: 67%;" /><span> </span></p><p>3️⃣<span>分页与分段的区别</span></p><ol start='' ><li><p><span>分段：段号由用户定义，每段大小和含义不同，地址是二维的(用户给出段号+用户给出偏移)</span></p></li><li><p><span>分页：页号由OS生成，页号无特殊含义，地址是一维的(OS给出页号+用户给出偏移)</span></p></li></ol></blockquote><h3 id='182-段表-段号段长段在内存的起始地址'><font color='orange'><span>1.8.2. 段表: [段号]+[段长]+[段在内存的起始地址]</span></font></h3><blockquote><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231023111114897.png" alt="image-20231023111114897" style="zoom: 67%;" /><span> </span></p></blockquote><h3 id='183-逻辑地址到物理地址的转换'><font color='cornflowerblue'><span>1.8.3. 逻辑地址到物理地址的转换</span></font></h3><blockquote><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231023112052840.png" alt="image-20231023112052840" style="zoom: 67%;" /><span>  </span></p><p>1️⃣<span>先对比段号AND段表长度，若段号超出，则中断</span></p><p>2️⃣<span>算出段表表项位置=段起始地址+段号*段表表项长度</span></p><p>3️⃣<span>读取表项内容，若段长&lt;段内位移，则中断(动态增长段除外)</span></p><p>4️⃣<span>根据表项中的段起始地址+段内位移→物理地址</span></p></blockquote><h3 id='184-段的共享与保护'><font color='cornflowerblue'><span>1.8.4. 段的共享与保护</span></font></h3><blockquote><p>1️⃣<span>共享：多个作业段表中相应表项指向被共享物理段的同一物理副本</span></p><p>2️⃣<span>保护的含义：</span></p><ol start='' ><li><p><span>一个作业在共享段读数据时，防止另一个作业修改内容</span></p></li><li><p><span>不可修改的数据/代码共享，可修改的不共享</span></p></li></ol><p><span>PS1：纯代码/可重入代码：不可修改的代码</span></p><p><span>PS2：共享的一个规则：不可修改代码与不可修改数据可共享，但可修改代码与可修改数据不可共享</span></p><p><span>PS3：大多系统中，程序都被分为代码区/数据区</span></p><p>3️⃣<span>保护的方式：地址越界保护(段号&gt;段表长就中断，偏移&gt;段长就中断)+访问控制保护(读写权限)</span></p></blockquote><h3 id='185-基本分段的特点'><font color='cornflowerblue'><span>1.8.5. 基本分段的特点</span></font></h3><blockquote><p>1️⃣<span>划为多模块：如代码段/数据段/共享段，分别编写/编译/保护，进行共享</span></p><ol start='' ><li><p><span>共享：把需要共享的代码/数据放在一段</span></p></li><li><p><span>保护：段信息独立，保护段就是保护信息</span></p></li></ol><p>2️⃣<span>碎片：没内碎片，外碎片可通过内存紧缩消除</span></p><p>2️⃣<span>缺点：需硬件支持，段最大尺寸受主存限制</span></p></blockquote><h3 id='186-分页分段对比'><font color='cornflowerblue'><span>1.8.6. 分页分段对比</span></font></h3><blockquote><figure class='table-figure'><table><thead><tr><th>&nbsp;</th><th style='text-align:left;' ><span>分 页</span></th><th style='text-align:left;' ><span>分 段</span></th></tr></thead><tbody><tr><td><span>目的</span></td><td style='text-align:left;' ><span>提高内存利用率</span></td><td style='text-align:left;' ><span>更好满足用户需要</span></td></tr><tr><td><span>单位划分</span></td><td style='text-align:left;' ><strong><span>页是信息的物理单位，页大小固定(由OS确定)</span></strong></td><td style='text-align:left;' ><span>段是</span><strong><span>信息的逻辑单位</span></strong><span>，其含义完整。段长不固定(用户确定)</span></td></tr><tr><td><span>作业地址空间</span></td><td style='text-align:left;' ><span>一维(页内偏移)</span></td><td style='text-align:left;' ><span>二维(段名+段内偏移)</span></td></tr><tr><td><span>内存分配</span></td><td style='text-align:left;' ><span>以页为单位离散分配，无外碎片</span></td><td style='text-align:left;' ><span>以段为单位离散分配，有外碎片(需要紧缩)</span></td></tr></tbody></table></figure></blockquote></blockquote><h2 id='19-基本段页式存储管理方式'><font color='cornflowerblue'><span>1.9. 基本段页式存储管理方式</span></font></h2><blockquote><h3 id='191-分段分页分块'><font color='cornflowerblue'><span>1.9.1. 分段分页&amp;分块</span></font></h3><blockquote><p>1️⃣<span>作业分段分页：先给作业的地址空间逻辑分段(每段有段号)，再给每段内分页</span></p><p>2️⃣<span>主存的分块(和分页管理一样)：分为如讴歌和页大小一样的块</span></p></blockquote><h3 id='192-段表与页表'><font color='cornflowerblue'><span>1.9.2. 段表与页表</span></font></h3><blockquote><p>1️⃣<span>段表：每进程拥有一张段表，结构为——段号+对应页表始址+页表长</span></p><p>2️⃣<span>页表：每个段表有一张页表，结构为——页号+块号</span></p></blockquote><h3 id='193-地址与地址变换'><font color='cornflowerblue'><span>1.9.3. 地址与地址变换</span></font></h3><blockquote><p>1️⃣<span>段页管理的虚拟地址结构</span></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231023115838241.png" alt="image-20231023115838241" style="zoom:67%;" /><span> </span></p><p>2️⃣<span>从虚拟地址到逻辑地址的变换</span></p><p><img src="https://raw.githubusercontent.com/DANNHIROAKI/New-Picture-Bed/main/img/image-20231023121807004.png" alt="image-20231023121807004" style="zoom:67%;" /><span> </span></p><ol start='' ><li><p><span>先对比段号和段表长度，如果段号大就中断</span></p></li><li><p><span>段起始地址与段号相加，得到所需段表项(表项：段号+页表长度+页表起始地址)</span></p></li><li><p><span>如果页号&gt;页表长度就中断</span></p></li><li><p><span>在通过页表起始地址+页号得到页表项目地址，通过该地址取出块号</span></p></li><li><p><span>块号+页内位移就是物理地址了，然后访问内存</span></p></li></ol></blockquote><h3 id='194-特点'><font color='cornflowerblue'><span>1.9.4. 特点</span></font></h3><blockquote><p>1️⃣<span>内部碎片太多：页式平均一个程序有半页碎片，段页式平均一段就有半页碎片(一个程序很多段)</span></p><p>2️⃣<span>为了获取一条指令或数据，需</span><strong><span>三次访问内存</span></strong><span> </span></p></blockquote></blockquote></blockquote></div></div>
</body>
</html>